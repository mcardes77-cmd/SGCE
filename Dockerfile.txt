# Use uma imagem base Python oficial
FROM python:3.11-slim

# Define o diretório de trabalho dentro do contêiner
WORKDIR /app

# Copia o arquivo de dependências e instala
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copia o restante do código da aplicação (incluindo app.py, routes_*.py, e templates/)
COPY . .

# Comando de execução do servidor WSGI (Gunicorn)
# Ele liga o Gunicorn à porta $PORT (fornecida pelo Cloud Run)
# 'app:app' diz: use o arquivo 'app.py' e a instância Flask chamada 'app'
CMD exec gunicorn --bind :$PORT --workers 2 --threads 4 app:app